SELECT 
CASE WHEN CODIGOBARRAPRODUTO <> '' THEN CODIGOBARRAPRODUTO ELSE PRODUTOS.ID_PRODUTOS END AS CODIGOBARRA,
CODIGOPRODUTO AS CODIGORAPIDO,
NOMEPRODUTO AS DESCRICAOCOMPLETA,
NOMEPRODUTO AS DESCRICAORESUMIDA,
GRUPOPRODUTOS.NOMEGRUPOPRODUTOS,
'' AS OBSERVACAO,
PRODUTOSPORLOCALVENDA.VALOR1 AS PRECOVENDA,
'A VISTA' AS TIPOPRECOVENDA,
CUSTOMEDIO AS PRECOCUSTO,
'UN' AS UNIDADEVENDA,
NCM,
CODIGOANP AS ANP,
TIPOTRIBUTACAO AS CST,
ALIQUOTAICMS AS ICMS,
CST_PIS AS CSTPISCOFINS,
'' AS NATUREZARECEITAPISCOFINS,
CFOP.CFOP AS CFOPVENDAPDV,
CFOP.CFOP AS CFOPVENDARETAGUARDA,
CFOP2.CFOP AS CFOPPADRAOCOMPRA

FROM PRODUTOS, PRODUTOSPORLOCALVENDA, GRUPOPRODUTOS, CFOP, CFOP AS CFOP2 WHERE 
PRODUTOSPORLOCALVENDA.VALOR1 > 0
AND PRODUTOS.ID_PRODUTOS = PRODUTOSPORLOCALVENDA.ID_PRODUTOS 
AND PRODUTOS.ID_LOCALVENDAS = PRODUTOSPORLOCALVENDA.ID_LOCALVENDAS 
AND PRODUTOS.ID_FILIAL = PRODUTOSPORLOCALVENDA.ID_FILIAL 
AND PRODUTOS.ATIVO = 1 
AND PRODUTOS.ID_GRUPOPRODUTOS = GRUPOPRODUTOS.ID_GRUPOPRODUTOS
AND PRODUTOS.ID_CFOPSAIDA = CFOP.ID_CFOP
AND PRODUTOS.ID_CFOPENTR = CFOP2.ID_CFOP
select
case when prodbarra <> '' then prodbarra else cast (prodcodigo as varchar) end as CODIGOBARRA,
proddescricao as DESCRICAOCOMPLETA,
prodresumo as DESCRICAORESUMIDA,
GPRO.GPRODESCRICAO AS SUBGRUPO,
prodv1 AS PRECOVENDA,
'PREÇO A VISTA' AS TIPOPRECOVENDA,
PRODCUSTO AS PRECOCUSTO,
prodund as UNIDADEVENDA,
PRODNCM AS NCM,
case when PRODANP > 0 then cast(prodanp as varchar) else '' end AS ANP,
PRODSTiC AS CSTICMS,
PRODICMS AS ICMS,
'' AS CSTPISCOFINS,
'' AS NATUREZARECEITAPISCOFINS,
PRODCFOP AS CFOPVENDAPDV,
PRODCFOP AS CFOPVENDARETAGUARDA,
PRODCFOP AS CFOPPADRAOCOMPRA FROM PROD, GPRO WHERE PROD.PRODGRUPO = GPRO.GPROCODIGO

//QUANDO NÃO TIVER PREÇOS NA PROD:

select
case when prodbarra <> '' then split_part(prodbarra, ',', 1) else cast (prodcodigo as varchar) end as CODIGOBARRA,
proddescricao as DESCRICAOCOMPLETA,
prodresumo as DESCRICAORESUMIDA,
GPRO.GPRODESCRICAO AS SUBGRUPO,
e_prod.E_prodv1 AS PRECOVENDA,
'PRECO A VISTA' AS TIPOPRECOVENDA,
E_PROD.E_PRODCUSTO AS PRECOCUSTO,
prodund as UNIDADEVENDA,
E_PROD.E_PRODNCM AS NCM,
case when PRODANP > 0 then cast(prodanp as varchar) else '' end AS ANP,
E_PROD.E_PRODSTIC AS CSTICMS,
E_PROD.E_PRODICMS AS ICMS,
'' AS CSTPISCOFINS,
'' AS NATUREZARECEITAPISCOFINS,
e_prod.e_PRODCFOP AS CFOPVENDAPDV,
e_prod.e_PRODCFOP AS CFOPVENDARETAGUARDA,
e_prod.e_PRODCFOP AS CFOPPADRAOCOMPRA FROM PROD, GPRO, E_PROD WHERE PROD.PRODGRUPO = GPRO.GPROCODIGO and E_PROD.E_PRODPRODUTO = PROD.PRODCODIGO